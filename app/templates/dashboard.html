<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard - MRX Systems</title>
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#059669">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Dashboard Professional Styles - Mobile First */
        .dashboard-container {
            padding: 80px 16px 100px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Período Selector */
        .period-selector {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 16px 0;
            margin-bottom: 24px;
            scrollbar-width: none;
        }

        .period-selector::-webkit-scrollbar {
            display: none;
        }

        .period-btn {
            flex-shrink: 0;
            padding: 10px 20px;
            border: 2px solid var(--gray-300);
            background: white;
            border-radius: 24px;
            font-weight: 600;
            font-size: 14px;
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            min-width: 80px;
            text-align: center;
        }

        .period-btn:active {
            transform: scale(0.95);
        }

        .period-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        /* KPI Cards Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
        }

        .kpi-card:active {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .kpi-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 12px;
        }

        .kpi-icon.success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .kpi-icon.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .kpi-icon.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .kpi-icon.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .kpi-label {
            font-size: 12px;
            color: var(--gray-600);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .kpi-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--gray-900);
            line-height: 1;
            margin-bottom: 8px;
        }

        .kpi-change {
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .kpi-change.positive {
            color: var(--success-color);
        }

        .kpi-change.negative {
            color: var(--danger-color);
        }

        /* Chart Cards */
        .chart-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 24px;
            border: 1px solid var(--gray-200);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-type-selector {
            display: flex;
            gap: 8px;
            background: var(--gray-100);
            padding: 4px;
            border-radius: 12px;
        }

        .chart-type-btn {
            padding: 8px 12px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 16px;
            color: var(--gray-600);
            -webkit-tap-highlight-color: transparent;
        }

        .chart-type-btn.active {
            background: white;
            color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .chart-container {
            position: relative;
            height: 300px;
            touch-action: pan-y;
        }

        /* Stats Grid */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            padding: 16px;
            background: var(--gray-50);
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-item-label {
            font-size: 11px;
            color: var(--gray-600);
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .stat-item-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--gray-900);
        }

        /* Ranking List */
        .ranking-list {
            list-style: none;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-bottom: 1px solid var(--gray-200);
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .ranking-item:active {
            background: var(--gray-50);
        }

        .ranking-position {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }

        .ranking-position.gold {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .ranking-position.silver {
            background: linear-gradient(135deg, #e5e7eb, #9ca3af);
            color: white;
        }

        .ranking-position.bronze {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
        }

        .ranking-position.regular {
            background: var(--gray-200);
            color: var(--gray-700);
        }

        .ranking-info {
            flex: 1;
        }

        .ranking-name {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 4px;
        }

        .ranking-value {
            font-size: 14px;
            color: var(--gray-600);
        }

        .ranking-count {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 18px;
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: var(--gray-500);
        }

        .spinner {
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (min-width: 768px) {
            .dashboard-container {
                padding: 100px 24px 40px;
            }

            .kpi-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .chart-container {
                height: 400px;
            }
        }

        /* Touch optimization */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        button, .btn, a {
            touch-action: manipulation;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content" style="justify-content: space-between;">
            <div class="logo">
                <img src="/static/images/mrx-logo.png" alt="MRX">
                <span>Dashboard</span>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div class="notification-badge" onclick="window.location.href='/notificacoes.html'">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count" id="headerNotificationCount" style="display: none;">0</span>
                </div>
                <button class="btn btn-secondary" onclick="logout()" style="font-size: 0.875rem; padding: 0.5rem 1rem;">Sair</button>
            </div>
        </div>
    </header>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav">
        <a href="/administracao.html" class="bottom-nav-item">
            <i class="fas fa-cog icon"></i>
            <span>Admin</span>
        </a>
        <a href="/dashboard.html" class="bottom-nav-item active">
            <i class="fas fa-chart-line icon"></i>
            <span>Dashboard</span>
        </a>
        <div class="fab-container">
            <button class="fab-button" onclick="openScanner()" aria-label="Scanner">
                <i class="fas fa-camera icon"></i>
            </button>
        </div>
        <a href="/solicitacoes.html" class="bottom-nav-item">
            <i class="fas fa-file-alt icon"></i>
            <span>Solicitações</span>
        </a>
        <a href="/empresas.html" class="bottom-nav-item">
            <i class="fas fa-building icon"></i>
            <span>Empresas</span>
        </a>
    </nav>

    <!-- Scanner Modal -->
    <div class="scanner-modal" id="scannerModal">
        <div class="scanner-modal-content">
            <div class="scanner-modal-header">
                <h2>Escanear Placa</h2>
                <button class="scanner-close" onclick="closeScanner()">&times;</button>
            </div>
            <form id="formScanner">
                <div class="form-group">
                    <label>Selecionar Empresa</label>
                    <select id="scannerEmpresa" required>
                        <option value="">Escolha uma empresa...</option>
                    </select>
                </div>
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-camera icon" style="font-size: 3rem; color: var(--primary-color);"></i>
                    <p>Toque para capturar ou selecionar imagem</p>
                    <input type="file" id="fileInput" accept="image/*" capture="environment" style="display: none;" onchange="previewImage(this)">
                </div>
                <div class="image-preview" id="imagePreview">
                    <img id="previewImg" alt="Preview">
                </div>
                <div class="form-group">
                    <label>Tipo de Placa</label>
                    <select id="tipoPlaca" required>
                        <option value="">Selecione...</option>
                        <option value="leve">Leve</option>
                        <option value="pesada">Pesada</option>
                        <option value="media">Média</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Peso (kg)</label>
                    <input type="number" id="pesoPlaca" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Valor Total (calculado automaticamente)</label>
                    <div id="valorCalculado" data-valor="0" style="padding: 0.75rem; background-color: #f0f0f0; border-radius: 5px; font-weight: bold; font-size: 1.1rem; color: #2c3e50;">R$ 0,00</div>
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-secondary w-full" id="btnCapturarLocalizacao" onclick="capturarLocalizacaoScanner()">
                        <i class="fas fa-map-marker-alt"></i> Capturar Localização
                    </button>
                    <div id="locationInfo" style="margin-top: 0.5rem; padding: 0.75rem; background: #e8f5e9; border-radius: 5px; display: none; font-size: 0.9rem; color: #2e7d32;"></div>
                </div>
                <button type="submit" class="btn btn-primary w-full">Registrar Placa</button>
            </form>
        </div>
    </div>

    <main class="dashboard-container">
        <!-- Period Selector -->
        <div class="period-selector">
            <button class="period-btn" onclick="changePeriod('hoje')" data-period="hoje">Hoje</button>
            <button class="period-btn" onclick="changePeriod('semana')" data-period="semana">Semana</button>
            <button class="period-btn active" onclick="changePeriod('mes')" data-period="mes">Mês</button>
            <button class="period-btn" onclick="changePeriod('trimestre')" data-period="trimestre">Trimestre</button>
            <button class="period-btn" onclick="changePeriod('ano')" data-period="ano">Ano</button>
            <button class="period-btn" onclick="changePeriod('tudo')" data-period="tudo">Tudo</button>
        </div>

        <!-- KPI Cards -->
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-icon warning">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="kpi-label">Pendentes</div>
                <div class="kpi-value" id="kpiPendentes">0</div>
                <div class="kpi-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span>Aguardando</span>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon success">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="kpi-label">Aprovados</div>
                <div class="kpi-value" id="kpiAprovados">0</div>
                <div class="kpi-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="kpiAprovadosChange">+0%</span>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon danger">
                    <i class="fas fa-times-circle"></i>
                </div>
                <div class="kpi-label">Reprovados</div>
                <div class="kpi-value" id="kpiReprovados">0</div>
                <div class="kpi-change negative">
                    <i class="fas fa-arrow-down"></i>
                    <span id="kpiReprovadosChange">-0%</span>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon info">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="kpi-label">Valor Total</div>
                <div class="kpi-value" id="kpiValorTotal">R$ 0</div>
                <div class="kpi-change positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="kpiValorChange">+0%</span>
                </div>
            </div>
        </div>

        <!-- Peso por Tipo -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    <i class="fas fa-weight"></i>
                    Peso por Tipo de Placa
                </div>
                <div class="chart-type-selector">
                    <button class="chart-type-btn active" onclick="changePesoChart('bar', this)" data-chart="peso">
                        <i class="fas fa-chart-bar"></i>
                    </button>
                    <button class="chart-type-btn" onclick="changePesoChart('pie', this)" data-chart="peso">
                        <i class="fas fa-chart-pie"></i>
                    </button>
                    <button class="chart-type-btn" onclick="changePesoChart('doughnut', this)" data-chart="peso">
                        <i class="fas fa-circle-notch"></i>
                    </button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="chartPeso"></canvas>
            </div>
        </div>

        <!-- Movimentação no Período -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    <i class="fas fa-chart-line"></i>
                    <span id="chartMovimentacaoTitle">Movimentação Mensal</span>
                </div>
                <div class="chart-type-selector">
                    <button class="chart-type-btn active" onclick="changeMovimentacaoChart('line', this)" data-chart="movimentacao">
                        <i class="fas fa-chart-line"></i>
                    </button>
                    <button class="chart-type-btn" onclick="changeMovimentacaoChart('bar', this)" data-chart="movimentacao">
                        <i class="fas fa-chart-bar"></i>
                    </button>
                    <button class="chart-type-btn" onclick="changeMovimentacaoChart('area', this)" data-chart="movimentacao">
                        <i class="fas fa-chart-area"></i>
                    </button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="chartMovimentacao"></canvas>
            </div>
        </div>

        <!-- Ranking de Empresas -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    <i class="fas fa-trophy"></i>
                    Ranking de Empresas
                </div>
            </div>
            <ul class="ranking-list" id="rankingEmpresas">
                <li class="loading">
                    <div class="spinner"></div>
                </li>
            </ul>
        </div>
    </main>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="/static/js/app.js"></script>
    <script>
        let currentPeriod = 'mes';
        let chartPeso = null;
        let chartMovimentacao = null;
        let dashboardData = null;

        async function carregarDashboard() {
            const userData = await verificarAuth();
            if (!userData) return;

            if (userData.tipo !== 'admin') {
                window.location.href = '/funcionario.html';
                return;
            }

            await loadDashboardData();
            await atualizarNotificacoes();
        }

        async function loadDashboardData() {
            try {
                const statsResponse = await fetchAPI('/dashboard/stats');
                dashboardData = await statsResponse.json();

                // Update KPIs
                document.getElementById('kpiPendentes').textContent = dashboardData.relatorios.pendentes;
                document.getElementById('kpiAprovados').textContent = dashboardData.relatorios.aprovados;
                document.getElementById('kpiReprovados').textContent = dashboardData.relatorios.reprovados;
                document.getElementById('kpiValorTotal').textContent = formatCurrency(dashboardData.valor_total);

                // Initialize Peso Chart
                initPesoChart();

                // Load Movimentacao Chart
                await loadMovimentacaoChart();

                // Load Ranking
                loadRanking();

            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
            }
        }

        function initPesoChart() {
            const ctx = document.getElementById('chartPeso').getContext('2d');
            
            if (chartPeso) {
                chartPeso.destroy();
            }

            const data = {
                labels: ['Leve', 'Média', 'Pesada'],
                datasets: [{
                    label: 'Peso (kg)',
                    data: [
                        dashboardData.quilos_por_tipo.leve || 0,
                        dashboardData.quilos_por_tipo.media || 0,
                        dashboardData.quilos_por_tipo.pesada || 0
                    ],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(245, 158, 11, 0.8)'
                    ],
                    borderColor: [
                        'rgb(16, 185, 129)',
                        'rgb(59, 130, 246)',
                        'rgb(245, 158, 11)'
                    ],
                    borderWidth: 2
                }]
            };

            chartPeso = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y.toFixed(2) + ' kg';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + ' kg';
                                }
                            }
                        }
                    }
                }
            });
        }

        async function loadMovimentacaoChart() {
            try {
                const graficoResponse = await fetchAPI('/dashboard/grafico-mensal');
                const graficoData = await graficoResponse.json();

                const ctx = document.getElementById('chartMovimentacao').getContext('2d');
                
                if (chartMovimentacao) {
                    chartMovimentacao.destroy();
                }

                chartMovimentacao = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: graficoData.labels,
                        datasets: [{
                            label: 'Solicitações Aprovadas',
                            data: graficoData.data,
                            borderColor: 'rgb(5, 150, 105)',
                            backgroundColor: 'rgba(5, 150, 105, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBackgroundColor: 'rgb(5, 150, 105)',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                cornerRadius: 8
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Erro ao carregar gráfico de movimentação:', error);
            }
        }

        function loadRanking() {
            const rankingHTML = dashboardData.ranking_empresas.map((empresa, index) => {
                let positionClass = 'regular';
                if (index === 0) positionClass = 'gold';
                else if (index === 1) positionClass = 'silver';
                else if (index === 2) positionClass = 'bronze';

                return `
                    <li class="ranking-item">
                        <div class="ranking-position ${positionClass}">${index + 1}</div>
                        <div class="ranking-info">
                            <div class="ranking-name">${empresa.nome}</div>
                            <div class="ranking-value">Total de solicitações aprovadas</div>
                        </div>
                        <div class="ranking-count">${empresa.total}</div>
                    </li>
                `;
            }).join('');

            document.getElementById('rankingEmpresas').innerHTML = rankingHTML || '<li class="ranking-item"><div class="ranking-info"><div class="ranking-name">Nenhuma empresa com solicitações aprovadas</div></div></li>';
        }

        function changePeriod(period) {
            currentPeriod = period;
            
            // Update button states
            document.querySelectorAll('.period-btn').forEach(btn => {
                if (btn.dataset.period === period) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // Update chart title
            const titles = {
                'hoje': 'Movimentação de Hoje',
                'semana': 'Movimentação Semanal',
                'mes': 'Movimentação Mensal',
                'trimestre': 'Movimentação Trimestral',
                'ano': 'Movimentação Anual',
                'tudo': 'Movimentação Total'
            };
            document.getElementById('chartMovimentacaoTitle').textContent = titles[period];

            // Reload data (you can implement API endpoints for different periods)
            loadDashboardData();
        }

        function changePesoChart(type, btnElement) {
            // Update button states
            document.querySelectorAll('[data-chart="peso"]').forEach(btn => {
                btn.classList.remove('active');
            });
            btnElement.classList.add('active');

            // Change chart type
            if (chartPeso) {
                chartPeso.destroy();
            }

            const ctx = document.getElementById('chartPeso').getContext('2d');
            const data = {
                labels: ['Leve', 'Média', 'Pesada'],
                datasets: [{
                    label: 'Peso (kg)',
                    data: [
                        dashboardData.quilos_por_tipo.leve || 0,
                        dashboardData.quilos_por_tipo.media || 0,
                        dashboardData.quilos_por_tipo.pesada || 0
                    ],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(245, 158, 11, 0.8)'
                    ],
                    borderColor: [
                        'rgb(16, 185, 129)',
                        'rgb(59, 130, 246)',
                        'rgb(245, 158, 11)'
                    ],
                    borderWidth: 2
                }]
            };

            chartPeso = new Chart(ctx, {
                type: type,
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: type === 'pie' || type === 'doughnut',
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.toFixed(2) + ' kg';
                                }
                            }
                        }
                    },
                    scales: type === 'bar' ? {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + ' kg';
                                }
                            }
                        }
                    } : {}
                }
            });
        }

        function changeMovimentacaoChart(type, btnElement) {
            // Update button states
            document.querySelectorAll('[data-chart="movimentacao"]').forEach(btn => {
                btn.classList.remove('active');
            });
            btnElement.classList.add('active');

            // Change chart appearance
            if (chartMovimentacao) {
                if (type === 'area') {
                    chartMovimentacao.config.type = 'line';
                    chartMovimentacao.data.datasets[0].fill = true;
                    chartMovimentacao.data.datasets[0].backgroundColor = 'rgba(5, 150, 105, 0.2)';
                } else {
                    chartMovimentacao.config.type = type;
                    chartMovimentacao.data.datasets[0].fill = type === 'line';
                    chartMovimentacao.data.datasets[0].backgroundColor = type === 'line' ? 'rgba(5, 150, 105, 0.1)' : 'rgba(5, 150, 105, 0.8)';
                }
                chartMovimentacao.update();
            }
        }

        carregarDashboard();
    </script>
</body>
</html>
